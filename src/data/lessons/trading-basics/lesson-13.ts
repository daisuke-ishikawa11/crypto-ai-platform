import type { Lesson } from '@/lib/types/learning';

export const lesson13: Lesson = {
  id: 'trading-basics-13',
  slug: 'cci-commodity-channel-index',
  title: 'CCI（商品チャネル指数）の活用法',
  description: 'ドナルド・ランバートが開発したCCIの仕組みを理解し、サイクリカルなトレンドの識別と±100を超える極値での売買判定に活用する方法を学習します。',
  categoryId: '3',
  difficultyLevel: 'intermediate',
  estimatedMinutes: 23,
  orderIndex: 13,
  isPublished: true,
  tags: ['CCI', '商品チャネル指数', 'サイクル', '極値', 'トレンド'],
  
  content: {
    sections: [
      {
        type: 'text',
        content: `# CCI（商品チャネル指数）とは

**CCI（Commodity Channel Index）**は、ドナルド・ランバートが1980年に開発したテクニカル指標で、**価格が統計的な平均からどれだけ乖離しているか**を測定します。元々は商品（コモディティ）のサイクリカルな動きを分析するために作られましたが、現在では株式、FX、暗号通貨など幅広い市場で活用されています。

## 基本的な計算方法

### 計算式
**CCI = (Typical Price - SMA) ÷ (0.015 × Mean Deviation)**

### 構成要素
1. **Typical Price = (High + Low + Close) ÷ 3**
2. **SMA = Typical Priceの単純移動平均（通常20期間）**
3. **Mean Deviation = |Typical Price - SMA|の平均**
4. **0.015 = 統計的定数（約75%のデータが±100内に収まるよう調整）**

### 標準設定
- **期間**: 20期間（標準）
- **短期**: 14期間（より敏感）
- **長期**: 30期間（より安定）
- **定数**: 0.015（固定値）

## CCIの特徴と他指標との違い

### 独特な特徴
- **無制限レンジ**: ±100を大きく超える値も取る
- **統計的根拠**: 標準偏差に基づく客観的計算
- **サイクル分析**: 周期性のあるパターンの検出
- **ブレイクアウト**: 極値突破での強いシグナル

### 他のオシレーターとの比較
- **RSI/ストキャスティクス**: 0-100%の固定レンジ
- **CCI**: 無制限レンジ、より大きな値動きを表現
- **感度**: CCIは価格変動により敏感
- **用途**: サイクル分析とトレンド継続性の判定

## 基本的な解釈

### レベル別の意味
- **+200以上**: 極度の買われすぎ、強いトレンド
- **+100～+200**: 買われすぎ圏
- **-100～+100**: 通常圏（約75%の時間）
- **-100～-200**: 売られすぎ圏
- **-200以下**: 極度の売られすぎ、強いトレンド

### 市場状況の判定
- **±100内**: レンジ相場、逆張り有効
- **±100超**: トレンド相場、順張り有効
- **±200超**: 極端相場、継続性注意`
      },

      {
        type: 'text',
        content: `# CCIの基本的な売買シグナル

## 逆張りシグナル（レンジ相場向け）

### 買いシグナル
1. **-100下抜け**: CCIが-100を上から下抜け
2. **底値確認**: -100～-200圏での底値形成
3. **-100回復**: CCIが-100を下から上抜け
4. **エントリー**: 回復確認後の買いポジション

### 売りシグナル
1. **+100上抜け**: CCIが+100を下から上抜け
2. **天井確認**: +100～+200圏での天井形成
3. **+100割れ**: CCIが+100を上から下割れ
4. **エントリー**: 割れ確認後の売りポジション

## 順張りシグナル（トレンド相場向け）

### 強い上昇トレンド
- **+100突破**: CCIが+100を勢いよく突破
- **+100維持**: +100以上での継続的推移
- **押し目**: 一時的な+100割れから再上抜け
- **戦略**: 上昇トレンド継続での買い保持

### 強い下降トレンド
- **-100突破**: CCIが-100を勢いよく突破
- **-100維持**: -100以下での継続的推移
- **戻り**: 一時的な-100回復から再下抜け
- **戦略**: 下降トレンド継続での売り保持

## ゼロライン分析

### ゼロラインクロス
- **上向きクロス**: CCIが0を下から上抜け（買いシグナル）
- **下向きクロス**: CCIが0を上から下抜け（売りシグナル）
- **中期的方向性**: ゼロライン上下で基本スタンス決定

### ゼロライン付近での動き
- **上側推移**: 基本的に強気相場
- **下側推移**: 基本的に弱気相場
- **頻繁なクロス**: レンジ相場、ダマシ多発注意`
      },

      {
        type: 'example',
        content: `## 実際のトレード例：イーサリアム分析

### 2024年冬季のCCI活用例

**1月上旬：レンジ相場での逆張り戦略**
- **価格状況**: $2,200-$2,500のレンジ相場継続
- **CCI状況**: +120到達後、+100割れで売りシグナル
- **確認**: 価格$2,480でレジスタンス反発同時発生
- **戦略**: $2,470での売りエントリー
- **利確**: CCI -80到達で$2,240付近利確
- **結果**: 5日間で10%の利益確保

**2月中旬：強いトレンドでの順張り戦略**
- **価格状況**: $2,300から上昇開始
- **CCI突破**: +100を勢いよく突破、+150まで上昇
- **継続確認**: +100以上で1週間継続推移
- **戦略**: +100回復時での押し目買い追加
- **保持**: CCI +100維持中はポジション継続
- **結果**: 3週間で$2,850まで24%上昇

**3月：極値からの反転シグナル**
- **価格状況**: $2,900で高値圏推移
- **CCI極値**: +220の極値到達（過去6ヶ月最高）
- **警戒信号**: 極値からの反転可能性示唆
- **確認**: +100割れと出来高減少同時発生
- **戦略**: $2,850での段階的利確実行
- **結果**: その後10日間で$2,550まで11%調整

**学習ポイント**: CCIの±100ライン突破方向で戦略を切り替えることが重要`
      },

      {
        type: 'tip',
        content: `**CCI活用のコツ**

1. **相場環境の判定**:
   - ±100内推移: レンジ相場として逆張り戦略
   - ±100超推移: トレンド相場として順張り戦略
   - 戦略の切り替えタイミングを重視

2. **極値の活用**:
   - ±200超: 極端な状況、反転可能性高い
   - 継続期間: 長期極値ほど反転の可能性増大
   - 他指標: RSI、ストキャスティクスとの同時確認

3. **時間軸の選択**: 日足以上での中長期分析に特に有効！`
      },

      {
        type: 'text',
        content: `# 実践的なCCI戦略

## レンジ相場戦略

### 基本的な逆張り手法
1. **環境確認**: 明確なレンジ相場の存在確認
2. **CCI監視**: ±100ラインへの接近確認
3. **極値確認**: ±100～±200圏での極値形成
4. **反転確認**: ±100ライン復帰確認
5. **エントリー**: 復帰確認後の逆張りエントリー

### リスク管理
- **ストップロス**: ±200突破で損切り（トレンド転換）
- **利確**: 反対側の±100ライン接近
- **ポジションサイズ**: 全資金の3-5%

## トレンドフォロー戦略

### 強いトレンド継続戦略
1. **ブレイクアウト**: ±100ラインの勢いよい突破確認
2. **継続確認**: ±100以上または以下での推移継続
3. **押し目・戻り**: 一時的な±100ライン接触
4. **追加エントリー**: ライン再突破での追加ポジション
5. **保有継続**: ±100ライン維持中のポジション保持

### エグジット判定
- **ライン割れ**: ±100ライン明確な逆抜け
- **極値到達**: ±200以上での反転可能性
- **ダイバージェンス**: 価格とCCIの乖離発生

## ダイバージェンス戦略

### 強気ダイバージェンス
- **価格**: より低い安値を記録
- **CCI**: より高い安値を記録（改善）
- **確認**: その後のゼロライン上抜け
- **エントリー**: ダイバージェンス + 確認シグナル

### 弱気ダイバージェンス
- **価格**: より高い高値を記録
- **CCI**: より低い高値を記録（悪化）
- **確認**: その後のゼロライン下抜け
- **エントリー**: ダイバージェンス + 確認シグナル

## マルチタイムフレーム戦略

### 時間軸の活用
- **長期軸（週足）**: メイントレンド・大きなサイクル確認
- **中期軸（日足）**: エントリー方向・タイミング決定
- **短期軸（4時間足）**: 精密なエントリーポイント調整

### 実践手順
1. **週足**: 大局的なサイクルとトレンド確認
2. **日足**: CCIの基本戦略（レンジ/トレンド）決定
3. **4時間足**: 具体的なエントリータイミング
4. **統合判断**: 複数時間軸での方向性一致確認`
      },

      {
        type: 'text',
        content: `# CCIの高度な活用法

## サイクル分析

### 周期性の発見
- **ピーク間隔**: +100以上のピーク間の期間測定
- **ボトム間隔**: -100以下のボトム間の期間測定
- **サイクル長**: 平均的な周期期間の算出
- **予測**: 次回転換時期の予測

### サイクルの活用
1. **時間要素**: サイクル終期での転換期待
2. **価格要素**: 極値での反転可能性増大
3. **複合判断**: 時間 + 価格での高精度予測
4. **戦略調整**: サイクル段階に応じた戦略変更

## 複数通貨での活用

### 相関分析
- **主要通貨**: BTC、ETHのCCI同調性確認
- **アルトコイン**: 主要通貨との関係性分析
- **逆相関**: USD建て vs BTC建ての関係
- **確認**: 複数通貨での同時シグナル

### ポートフォリオ戦略
1. **分散エントリー**: 複数通貨での時間差エントリー
2. **リスク分散**: CCIレベル別のポジション配分
3. **相互確認**: 主導通貨での先行確認
4. **総合判断**: 市場全体のCCIトレンド把握

## パラメーター最適化

### 期間設定の調整
- **14期間**: より敏感、短期取引向け
- **20期間**: 標準設定、バランス型
- **30期間**: より安定、長期分析向け
- **動的調整**: 市場ボラティリティに応じた変更

### 閾値レベルの調整
- **標準**: ±100ライン
- **敏感**: ±75ライン（シグナル増加）
- **保守**: ±125ライン（シグナル厳選）
- **極値**: ±200ライン（極端相場判定）

## 実践的な改善方法

### 市場特性への適応
1. **ボラティリティ**: 高ボラ時の閾値調整
2. **流動性**: 低流動性時の慎重判断
3. **時間帯**: アクティブ時間での精度向上
4. **イベント**: 重要発表時の取引調整

### 継続的改善
- **バックテスト**: 過去データでの検証実施
- **最適化**: パラメーター調整の効果測定
- **記録**: CCIパターンと結果の記録保持
- **学習**: 新しいパターンの発見と活用

## CCIと他指標の組み合わせ

### CCI + 移動平均線
- **トレンド**: 移動平均で大方向確認
- **タイミング**: CCIで精密エントリー
- **フィルター**: トレンド方向のシグナル採用

### CCI + ボリンジャーバンド
- **価格位置**: バンド内位置とCCIレベル
- **ブレイク**: バンド突破 + CCI極値
- **確認**: 両指標での同時シグナル

### CCI + RSI
- **強度確認**: 両指標での買われすぎ・売られすぎ
- **ダイバージェンス**: 2指標での同時ダイバージェンス
- **信頼性**: 複数確認での精度向上`
      },

      {
        type: 'quiz',
        content: '理解度チェック',
        metadata: {
          questions: [
            {
              question: 'CCIが+150を示している場合、どのような戦略が適切ですか？',
              options: [
                '買われすぎなので即座に売りエントリー',
                '強いトレンドなので上昇継続を期待した買い保持',
                '中立的な状況なので様子見',
                'レンジ相場なので逆張り戦略'
              ],
              correctAnswer: '強いトレンドなので上昇継続を期待した買い保持',
              explanation: 'CCIが+100を超えて+150にある場合は強い上昇トレンドを示しており、+100以上では順張り戦略でトレンド継続を期待するのが適切です。'
            }
          ]
        }
      },

      {
        type: 'warning',
        content: `**CCI使用時の注意点**

### 1. 戦略の混同リスク
**問題**: レンジ相場とトレンド相場での戦略混同
**対策**:
- ±100ライン位置での戦略明確化
- 相場環境の事前確認徹底
- 戦略切り替えタイミングの習得
- 一貫性のある手法適用

### 2. 極値での早期反転期待
**問題**: ±200超での性急な逆張りエントリー
**対策**:
- 極値継続の可能性考慮
- 明確な反転シグナル待ち
- ポジションサイズの適切な管理
- 段階的なエントリー・エグジット

### 3. ダマシシグナルの頻発
**問題**: 短期時間軸でのノイズ多発
**対策**:
- 長期時間軸での確認併用
- 他のテクニカル指標との組み合わせ
- 出来高・価格アクションでの確認
- 経済指標発表時の取引回避

### 4. サイクル分析の過信
**問題**: 過去のサイクルパターンへの過度な依存
**対策**:
- 市場環境変化への適応
- ファンダメンタル要因の考慮
- 柔軟な戦略調整
- リスク管理の徹底

**成功の秘訣**: CCIは相場環境に応じた戦略の使い分けが最も重要です。±100ラインを基準とした明確な戦略切り替えを心がけましょう。`
      }
    ],

    keyPoints: [
      'CCIは価格の統計的平均からの乖離度を測定する無制限レンジの指標',
      '±100ライン内はレンジ相場、超えた場合はトレンド相場として戦略変更',
      '±200を超える極値は強いトレンドまたは反転の可能性を示す',
      'ゼロラインクロスは中期的な方向転換のシグナル',
      'サイクリカルな動きの分析に特に優れた指標',
      'ダイバージェンス分析でトレンド転換の早期発見',
      '他のテクニカル指標との組み合わせで精度向上',
      '相場環境に応じた戦略の使い分けが成功の鍵'
    ]
  }
}; 