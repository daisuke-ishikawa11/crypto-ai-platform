import { Lesson } from '@/lib/types/learning'

export const lesson9: Lesson = {
  id: 'crypto-basics-transactions-fees',
  categoryId: 'crypto-basics',
  title: '送金と手数料の仕組み',
  slug: 'transactions-and-fees',
  description: '暗号通貨の送金プロセス、トランザクションの仕組み、手数料の決まり方を学びます',
  difficultyLevel: 'beginner',
  estimatedMinutes: 25,
  orderIndex: 9,
  content: {
    sections: [
      {
        type: 'text',
        title: '暗号通貨の送金とは',
        content: `暗号通貨の送金は、ブロックチェーン上でデジタル資産の所有権を移転するプロセスです。銀行送金とは異なり、中央管理者を介さずに直接送金できます。

**送金の特徴**
- **P2P（ピア・ツー・ピア）**: 個人間で直接送金
- **24時間365日**: いつでも送金可能
- **国境なし**: 世界中どこでも同じ方法
- **不可逆性**: 一度送金したら取り消し不可

**送金に必要なもの**
1. **送金元ウォレット**: 秘密鍵を管理
2. **送金先アドレス**: 受取人の公開アドレス
3. **送金額**: 送りたい暗号通貨の量
4. **手数料**: ネットワーク手数料`
      },
      {
        type: 'text',
        title: 'トランザクションの仕組み',
        content: `**トランザクションの流れ**

1. **トランザクション作成**
   - 送金情報を入力
   - 秘密鍵で署名
   - ブロードキャスト（配信）

2. **メモリプール**
   - 未承認トランザクションの待機場所
   - マイナー/バリデーターが選択
   - 手数料の高い順に優先

3. **ブロックへの取り込み**
   - マイナーがブロックに含める
   - ブロックの生成
   - ネットワークに配信

4. **承認（Confirmation）**
   - 1承認: ブロックに含まれる
   - 3-6承認: 一般的な安全基準
   - 取引所は独自基準

**トランザクションの内容**
- **インプット**: 送金元の情報
- **アウトプット**: 送金先と金額
- **署名**: 秘密鍵による認証
- **手数料**: マイナーへの報酬`
      },
      {
        type: 'text',
        title: '手数料の仕組み',
        content: `**なぜ手数料が必要か**
- マイナー/バリデーターへの報酬
- スパム攻撃の防止
- ネットワークの維持費用
- 優先処理の仕組み

**手数料の決まり方**

**ビットコイン**
- **単位**: satoshi/byte（vByte）
- **計算**: トランザクションサイズ × 手数料率
- **相場**: ネットワーク混雑度で変動
- **目安**: 
  - 低速: 1-10 sat/vB
  - 標準: 10-50 sat/vB
  - 高速: 50+ sat/vB

**イーサリアム**
- **単位**: Gwei（1 Gwei = 0.000000001 ETH）
- **計算**: ガス使用量 × ガス価格
- **EIP-1559後**:
  - Base Fee: 自動調整される基本料金
  - Priority Fee: マイナーへのチップ
- **目安**:
  - 送金: 21,000 ガス
  - DeFi: 100,000-300,000 ガス

**手数料の節約方法**
- 混雑時を避ける
- 適切な手数料設定
- バッチ送金の利用
- Layer 2の活用`
      },
      {
        type: 'text',
        title: '送金の実践',
        content: `**送金前の確認事項**

1. **アドレスの確認**
   - 最初と最後の文字を確認
   - QRコードの活用
   - テスト送金の実施
   - コピペミスに注意

2. **ネットワークの確認**
   - 同じネットワーク同士
   - ERC-20、BEP-20などの規格
   - クロスチェーンは別途手順

3. **手数料の見積もり**
   - 現在の相場確認
   - 急ぎでない場合は低めに
   - 手数料サイトの活用

**送金手順（一般的な流れ）**
1. ウォレットを開く
2. 「送金」をクリック
3. 送金先アドレスを入力
4. 金額を入力
5. 手数料を設定
6. 内容を確認
7. 送金実行（署名）

**送金後の確認**
- トランザクションID（TxID）の保存
- ブロックエクスプローラーで確認
- 承認数の確認
- 受取人への連絡`
      },
      {
        type: 'text',
        title: 'よくあるトラブルと対処法',
        content: `**送金が遅い・詰まった**
原因：手数料が低すぎる

対処法：
- Replace-By-Fee（RBF）で手数料を上げる
- Child-Pays-For-Parent（CPFP）
- 待つ（最終的には処理される）

**間違ったアドレスに送金**
- 基本的に取り戻せない
- 送金先が判明していれば連絡
- 少額テストの重要性

**違うネットワークに送金**
例：BinanceのETHアドレスにERC-20で送金
- 取引所のサポートに連絡
- 回収手数料がかかる場合も
- セルフカストディなら永久に失われる

**送金が届かない**
確認事項：
1. TxIDで状況確認
2. 正しいアドレスか
3. 正しいネットワークか
4. 最低送金額を満たしているか
5. 取引所の入金反映時間

**手数料の失敗例**
- 手数料をゼロに設定 → 永遠に処理されない
- 手数料が高すぎる → 無駄な出費
- ガス不足（ETH） → トランザクション失敗`
      },
      {
        type: 'tip',
        title: '安全な送金のベストプラクティス',
        content: `**必ず守るべきルール**
1. **少額でテスト送金**: 初めての送金先には必ず
2. **アドレスの二重確認**: 最初4文字、最後4文字
3. **ネットワークの確認**: 特に取引所送金時
4. **手数料の確認**: 送金額に対して適切か
5. **フィッシング対策**: 公式サイトから操作

**推奨事項**
- アドレス帳機能の活用
- ハードウェアウォレットの使用
- 大口送金は分割で
- 履歴の保存（税務対策）
- 定期的なウォレット更新`
      },
      {
        type: 'quiz',
        title: '理解度チェック',
        questions: [
          {
            id: 'q1',
            questionType: 'multiple_choice',
            question: '暗号通貨の送金で最も重要な確認事項は？',
            options: [
              '送金速度',
              '送金先アドレスとネットワーク',
              '現在の価格',
              '取引所の営業時間'
            ],
            correctAnswer: '1',
            explanation: '送金先アドレスとネットワークの確認が最重要です。間違えると資産を失う可能性があります。'
          },
          {
            id: 'q2',
            questionType: 'multiple_choice',
            question: 'ビットコインの手数料単位は？',
            options: [
              'Gwei',
              'satoshi/byte',
              'BTC/KB',
              'USD/transaction'
            ],
            correctAnswer: '1',
            explanation: 'ビットコインの手数料はsatoshi/byte（またはsat/vB）で計算されます。Gweiはイーサリアムの単位です。'
          },
          {
            id: 'q3',
            questionType: 'multiple_choice',
            question: '送金が遅い場合の最も一般的な原因は？',
            options: [
              'インターネット速度が遅い',
              '手数料が低すぎる',
              'ウォレットのバグ',
              '受取人の問題'
            ],
            correctAnswer: '1',
            explanation: '手数料が低すぎると、マイナーに選ばれにくくなり、送金が遅くなります。'
          }
        ]
      }
    ]
  }
} 