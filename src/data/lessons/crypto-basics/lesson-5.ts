import type { Lesson } from '../../../lib/types/learning';

export const lesson5: Lesson = {
  id: 'crypto-basics-5',
  categoryId: 'crypto-basics',
  title: 'Public vs Private Keys - キー管理の基礎',
  slug: 'public-private-keys',
  description: '暗号通貨のセキュリティの根幹である公開鍵・秘密鍵システムの仕組みと安全な管理方法を学びます。',
  difficultyLevel: 'beginner',
  estimatedMinutes: 22,
  orderIndex: 5,
  content: {
    sections: [
      {
        type: 'text',
        title: '公開鍵暗号の基本概念',
        content: `暗号通貨のセキュリティは公開鍵暗号システムに基づいています。1970年代に発明された革新的な暗号技術で、数学的に関連する2つの鍵を使用します。

          システムの構成
          
          秘密鍵（Private Key）は絶対に秘匿すべき鍵で、暗号通貨の真の所有権を証明します。公開鍵（Public Key）は誰にでも公開可能な鍵で、受取アドレスの生成などに使用されます。重要なのは、秘密鍵から公開鍵は生成可能ですが、その逆は数学的に不可能という点です。
          
          基本原理
          
          秘密鍵で署名を行い、公開鍵で検証する仕組みになっています。また、公開鍵で暗号化されたデータは秘密鍵でのみ復号化可能です。これらのセキュリティは楕円曲線暗号（ECC）という高度な数学的手法により保証されています。
          
          日常の例え
          
          秘密鍵は銀行口座の暗証番号のようなもので、絶対に他人に知られてはいけません。公開鍵は銀行口座番号のようなもので、送金を受ける際に相手に伝える必要があります。デジタル署名は取引への署名・承認として機能します。`
      },
      {
        type: 'text',
        title: '暗号通貨における鍵の役割',
        content: `秘密鍵の役割
        
          秘密鍵は暗号通貨における最も重要な要素です。所有権の証明として、その暗号通貨の真の所有者であることを数学的に証明します。送金取引を行う際には、秘密鍵でデジタル署名を追加することで取引の正当性を保証します。つまり、秘密鍵を持つことは資産への完全なアクセス権を意味します。
          
          公開鍵の役割
          
          公開鍵からは受信用のウォレットアドレスが生成され、これにより他者からの送金を受け取ることができます。また、取引が正当な所有者からのものかを検証する際にも使用されます。一部のケースでは通信の暗号化にも利用されます。
          
          重要な原則
          
          暗号通貨界では「Not your keys, not your crypto」という格言があります。これは、あなたが秘密鍵を管理していなければ、それは真の意味であなたの暗号通貨ではないということを意味します。
          
          鍵の生成過程
          
          まず乱数を生成して256ビットの秘密鍵を作成します。次に楕円曲線暗号の計算により公開鍵を生成し、最後にハッシュ関数を適用してウォレットアドレスを作成します。この過程は一方向性で、逆算は実質的に不可能です。`
      },
      {
        type: 'text',
        title: '鍵の形式と表現',
        content: `秘密鍵の表現形式
        
          秘密鍵は複数の形式で表現されます。16進数形式（Hex）では、E9873D79C6D87DC0FB6A5778633389F4453213303DA61F20BD67FC233AA33262のような64文字の文字列になります。
          
          WIF（Wallet Import Format）では、5Kb8kLf9zgWQnogidDA76MzPL6TsZZY36hWXMssSzNydYXYB9KFのような形式で表現されます。これはBase58エンコーディングを使用した読みやすい形式です。
          
          最も人間にとって扱いやすいのがニーモニックフレーズ（BIP39）で、「abandon ability able about above absent absorb abstract absurd abuse access accident account accuse achieve acid acoustic acquire across act action」のような12〜24個の英単語の組み合わせで表現されます。
          
          公開鍵とアドレス
          
          公開鍵は通常130文字の16進数文字列として表現されます。ビットコインアドレスは1で始まる形式、3で始まる形式、またはbc1で始まるBech32形式があります。イーサリアムアドレスは0xで始まる42文字の文字列です。`
      },
      {
        type: 'text',
        title: '安全な鍵管理のベストプラクティス',
        content: `秘密鍵管理の重要原則
        
          絶対に共有しない
          
          秘密鍵は絶対に他人に教えてはいけません。正当なサポートスタッフが秘密鍵を聞いてくることは絶対にありません。フィッシング詐欺では、偽のサイトで秘密鍵の入力を求められることがありますので、十分注意してください。
          
          安全な保存方法
          
          最も安全なのはコールドストレージで、インターネットから完全に切り離された環境で保管します。ハードウェアウォレットという専用デバイスを使用する方法も効果的です。ペーパーウォレットとして紙に印刷して物理的に保管する方法もありますが、火災や水害に備えてメタル製のバックアップを作成することも推奨されます。
          
          バックアップの重要性
          
          複数の場所にバックアップを保存し、ニーモニックフレーズを正確に記録することが重要です。定期的にバックアップが正しく機能するかを確認することも忘れてはいけません。
          
          セキュリティ対策
          
          2FA（二要素認証）を有効化し、定期的にセキュリティソフトでスキャンを行います。公共Wi-Fiでの秘密鍵操作は避け、ソーシャルエンジニアリング攻撃にも注意を払うことが重要です。`
      }
    ],
    keyPoints: [
      '秘密鍵は暗号通貨資産への完全なアクセス権を意味する',
      '公開鍵は秘密鍵から生成されるが、逆は数学的に不可能',
      '秘密鍵を失うと資産に永久にアクセスできなくなる',
      'ニーモニックフレーズは秘密鍵の人間が読める形式',
      '「Not your keys, not your crypto」が鉄則',
      'コールドストレージが最も安全な保管方法'
    ],
    summary: '公開鍵暗号システムは暗号通貨のセキュリティの基盤です。秘密鍵が資産の完全なコントロール権を持つため、その安全な管理が極めて重要です。適切なバックアップ戦略とセキュリティ対策により、資産を長期的に保護できます。',
    practicalExamples: [
      'ビットコインアドレス例: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa（サトシ・ナカモトの最初の取引）',
      'イーサリアムアドレス例: 0x742d35Cc6604C532532C3C435028C95D33FE2B6F',
      '秘密鍵紛失事例: James Howells氏 7,500BTC（2025年8月現在約$890M相当）をハードドライブ廃棄で紛失',
      'ニーモニック例: 12-24単語で秘密鍵を表現、順序と正確性が資産の生死を分ける'
    ],
    warningNotes: [
      '秘密鍵を紛失すると資産を永久に失う（復旧不可能）',
      '秘密鍵が盗まれると資産が瞬時に盗まれる',
      'フィッシングサイトで秘密鍵を入力しない',
      'スクリーンショットや写真で秘密鍵を保存しない',
      'クラウドストレージに暗号化せずに保存しない',
      '口頭やメッセージで秘密鍵を共有しない'
    ]
  },
  quiz: [
    {
      id: 'crypto-basics-5-q1',
      question: '「Not your keys, not your crypto」の意味は？',
      options: [
        '鍵を持たないと暗号通貨を買えない',
        '秘密鍵を管理していないと真の所有者ではない',
        '公開鍵がないと取引できない',
        '暗号通貨には物理的な鍵が必要'
      ],
      correctAnswer: 1,
      explanation: '秘密鍵を自分で管理していない限り、その暗号通貨の真の所有者とは言えません。取引所などに預けている場合、実質的にはその企業が管理しています。'
    },
    {
      id: 'crypto-basics-5-q2',
      question: '公開鍵と秘密鍵の関係で正しいのは？',
      options: [
        '公開鍵から秘密鍵を計算できる',
        '秘密鍵から公開鍵を生成できる',
        '両方とも常に同じ値',
        'どちらも毎回ランダムに生成される'
      ],
      correctAnswer: 1,
      explanation: '秘密鍵から公開鍵は数学的に生成できますが、公開鍵から秘密鍵を逆算することは計算上不可能です。'
    },
    {
      id: 'crypto-basics-5-q3',
      question: '最も安全な秘密鍵の保存方法は？',
      options: [
        'クラウドストレージに保存',
        'スマートフォンのメモアプリ',
        'コールドストレージ（オフライン保管）',
        'メールで自分に送信'
      ],
      correctAnswer: 2,
      explanation: 'コールドストレージ（完全オフライン環境）は、ハッキングやマルウェアのリスクがないため最も安全な保存方法です。'
    },
    {
      id: 'crypto-basics-5-q4',
      question: 'ニーモニックフレーズ（シードフレーズ）の特徴は？',
      options: [
        '暗号通貨ごとに異なる',
        '12-24単語で秘密鍵を表現',
        '公開鍵と同じもの',
        '毎回変更が必要'
      ],
      correctAnswer: 1,
      explanation: 'ニーモニックフレーズは通常12-24個の英単語で構成され、人間が読みやすい形式で秘密鍵を表現するBIP39標準です。'
    }
  ],
  lastUpdated: '2025-08-15',
  factChecked: true
};