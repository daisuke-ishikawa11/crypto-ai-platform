# 📋 **暗号通貨AIプラットフォーム再構築プロジェクト - 実行ルール**

## 🎯 **基本原則（絶対遵守）**

### **1. ハイブリッド戦略の厳格適用**
```typescript
const hybridStrategy = {
  "設計思想": "95%継承・完全活用",
  "実装コード": "100%刷新・偽装完全排除", 
  "判断基準": "設計思想は継承、コードは新規作成",
  "禁止事項": "既存コードのコピペ・偽装実装の流用"
}
```

### **2. 品質最優先原則**
- **動作しない機能は実装しない** - 偽装・モック・ダミーの完全禁止
- **テスト駆動開発** - 実装前にテストケース作成
- **型安全性の徹底** - TypeScript strict mode必須
- **エラーハンドリング完備** - 全API・関数にエラー処理実装

### **3. 段階的価値提供**
- **MVP優先** - 完璧より動作する最小機能
- **ユーザーフィードバック重視** - 各Phase後にユーザー検証
- **継続的改善** - 小さな改善の積み重ね

---

## 🚫 **絶対禁止事項**

### **既存システムからの継承禁止**
1. **コードの直接コピー** - 一切のコードコピーを禁止
2. **偽装実装の流用** - ダミーデータ・モック応答の使用禁止
3. **技術的負債の継承** - 古い依存関係・設計パターンの流用禁止
4. **セキュリティホールの継承** - 既存の脆弱性パターンの回避

### **開発プロセス禁止事項**
```typescript
const prohibitedPractices = {
  "一気に大きな変更": "小さな変更の積み重ねを必須とする",
  "理論先行": "実際の動作確認を優先する", 
  "確認を怠る": "各段階で必ずE2Eテスト実行",
  "ユーザビリティ軽視": "使いやすさを最優先する"
}
```

---

## ✅ **必須実行事項**

### **Phase開始前の必須作業**
1. **E2Eテストでの現状確認** - 既存システムの問題点明確化
2. **設計思想の文書化** - 継承する設計要素の明文化
3. **技術選定の検証** - 新技術の動作確認・概念実証
4. **ユーザーストーリー作成** - 実装する機能の価値明確化

### **実装中の必須作業**
```typescript
const mandatoryTasks = {
  "毎日": [
    "動作確認テストの実行",
    "コードレビュー（セルフチェック）",
    "進捗記録・問題点の文書化"
  ],
  "週次": [
    "統合テストの実行", 
    "パフォーマンステスト",
    "セキュリティチェック",
    "ユーザビリティ検証"
  ],
  "Phase完了時": [
    "包括的E2Eテスト",
    "ユーザー受け入れテスト",
    "次Phaseの詳細計画策定"
  ]
}
```

---

## 🔧 **技術実装ルール**

### **フロントエンド実装ルール**
```typescript
const frontendRules = {
  "フレームワーク": "Next.js 14 App Router必須",
  "言語": "TypeScript strict mode必須",
  "スタイリング": "Tailwind CSS + shadcn/ui",
  "状態管理": "Zustand + TanStack Query",
  "コンポーネント": {
    "設計": "既存設計思想を完全継承",
    "実装": "現代的手法で新規作成",
    "再利用性": "高い再利用性を保つ",
    "テスト": "各コンポーネントにテスト必須"
  }
}
```

### **バックエンド実装ルール**
```typescript
const backendRules = {
  "基盤": "Supabase + PostgreSQL",
  "API": "Next.js API Routes + Server Actions",
  "認証": "Supabase Auth（既存権限設計継承）",
  "セキュリティ": {
    "RLS": "Row Level Security必須",
    "バリデーション": "全入力値検証必須",
    "暗号化": "機密データの暗号化必須",
    "監査ログ": "重要操作の記録必須"
  }
}
```

### **AI機能実装ルール**
```typescript
const aiImplementationRules = {
  "偽装完全禁止": "ダミー・モック応答の使用禁止",
  "真のAPI統合": "OpenAI・Anthropic等の実API必須",
  "エラーハンドリング": "API失敗時の適切な処理必須",
  "コスト管理": "API使用量の監視・制限実装",
  "品質保証": {
    "応答検証": "AI応答の妥当性チェック",
    "フォールバック": "API失敗時の代替処理",
    "ログ記録": "AI処理の詳細ログ保存"
  }
}
```

---

## 📊 **品質管理ルール**

### **コード品質基準**
```typescript
const qualityStandards = {
  "TypeScript": {
    "strictMode": true,
    "noAny": "any型の使用禁止",
    "typeAnnotation": "全関数に型注釈必須"
  },
  "テストカバレッジ": {
    "minimum": "80%以上",
    "critical": "重要機能は95%以上",
    "e2e": "主要ユーザーフローは100%"
  },
  "パフォーマンス": {
    "loadTime": "初期読み込み2秒以内",
    "apiResponse": "API応答100ms以内",
    "bundleSize": "JavaScript bundle 500KB以下"
  }
}
```

### **セキュリティ基準**
```typescript
const securityStandards = {
  "認証": "Supabase Auth + JWT",
  "認可": "RLS + 役割ベースアクセス制御",
  "データ保護": "個人情報の暗号化必須",
  "API保護": "レート制限・入力検証必須",
  "監査": "セキュリティ関連操作のログ記録"
}
```

---

## 🔄 **プロセス管理ルール**

### **Phase管理ルール**
```typescript
const phaseManagement = {
  "Phase開始条件": [
    "前Phaseの完全完了確認",
    "品質基準の達成確認", 
    "ユーザーテストの合格",
    "次Phase計画の詳細化"
  ],
  "Phase中断条件": [
    "重大なセキュリティ問題発見",
    "品質基準の大幅未達",
    "技術的実現不可能性の判明"
  ],
  "緊急対応": [
    "問題の即座報告・文書化",
    "代替案の検討・実装",
    "計画の見直し・調整"
  ]
}
```

### **コミュニケーションルール**
```typescript
const communicationRules = {
  "進捗報告": {
    "頻度": "毎日の進捗更新",
    "内容": "完了項目・課題・次日計画",
    "形式": "定型フォーマット使用"
  },
  "問題報告": {
    "即座報告": "重大問題は即座に報告",
    "詳細記録": "問題・原因・対策の詳細記録",
    "解決確認": "解決後の動作確認必須"
  }
}
```

---

## 🎯 **成功判定基準**

### **Phase別成功基準**
| Phase | 期間 | 成功基準 | 品質指標 |
|-------|------|----------|----------|
| **Phase 1** | Week 1-2 | 認証・権限システム完全動作 | E2Eテスト100%合格 |
| **Phase 2** | Week 3-6 | 5段階プラン完全実装 | ユーザビリティテスト合格 |
| **Phase 3** | Week 7-10 | 真のAI機能動作確認 | AI応答品質95%以上 |
| **Phase 4** | Week 11-14 | 外部API完全統合 | 統合テスト100%合格 |
| **Phase 5** | Week 15-16 | 本番環境完全稼働 | パフォーマンス目標達成 |

### **最終成功基準**
```typescript
const finalSuccessCriteria = {
  "機能性": "全機能が偽装なしで実動作",
  "パフォーマンス": "応答時間・読み込み速度目標達成",
  "セキュリティ": "セキュリティ監査合格",
  "ユーザビリティ": "ユーザー満足度90%以上",
  "保守性": "コード品質・文書化基準達成",
  "拡張性": "将来機能追加の容易性確認"
}
```

---

## ⚠️ **リスク管理ルール**

### **リスク監視項目**
```typescript
const riskMonitoring = {
  "技術リスク": [
    "外部API制限・障害",
    "パフォーマンス劣化",
    "セキュリティ脆弱性"
  ],
  "スケジュールリスク": [
    "実装遅延",
    "品質基準未達",
    "技術的困難"
  ],
  "品質リスク": [
    "ユーザビリティ問題",
    "機能不具合",
    "データ整合性問題"
  ]
}
```

### **リスク対応ルール**
1. **早期発見** - 毎日のリスク評価実施
2. **即座対応** - 問題発見から24時間以内の対策着手
3. **代替案準備** - 主要機能に対する代替実装の準備
4. **エスカレーション** - 重大リスクの即座報告・相談

---

## 🎯 **ルール適用の監視・改善**

### **ルール遵守の確認方法**
```typescript
const ruleCompliance = {
  "日次チェック": "毎日のセルフチェックリスト実行",
  "週次レビュー": "週次での包括的ルール遵守確認", 
  "Phase完了時": "全ルール遵守状況の詳細監査",
  "継続改善": "ルールの有効性評価・必要に応じた更新"
}
```

---

## 🌟 **革新的ハイブリッド戦略のポイント**

### **1. 設計思想の「再利用」と「刷新」のハイブリッド戦略**
- **既存システムのアーキテクチャ思想（設計思想）を95%以上活用しつつ、コードや実装は完全に刷新**
- 過去の運用・設計ノウハウの蓄積を最大限に活かしつつ、技術的負債や偽装・破損コードを一切引き継がない

### **2. 現代的技術スタックによる劇的向上**
- **Next.js 14 + Supabase + TypeScript + OpenAI/Anthropic API**などの最新技術を全面採用
- 開発期間：50-76週間 → 4-6週間（90%短縮）
- 運用コスト：$1,000+ → $165/月（85%削減）

### **3. 「偽装排除」と「真のAI機能」への転換**
- 既存システムの「AI機能偽装」や「ダミーデータ」を完全に排除
- **OpenAIやAnthropic等の本物のAIサービスを統合**

### **4. 段階的・段階リリース戦略**
- MVP（4-6週間）→ AI統合（Week 7-10）→ 完全版（Week 11-16）
- ユーザーフィードバックを反映しながら段階的に拡張

### **5. 「品質・運用・拡張性」すべてを両立**
- サーバーレス、リアルタイムDB、エンタープライズ級セキュリティ設計
- 既存の業務・組織体制や将来のビジネス拡張にも柔軟に対応

---

## 📝 **毎日のチェックリスト**

### **開発開始時（毎朝）**
- [ ] 前日の進捗・課題の確認
- [ ] 本日の目標・タスクの明確化
- [ ] 技術環境の動作確認
- [ ] このルールファイルの確認
- [ ] 文字化け対策・エンコーディング確認

### **開発中（随時）**
- [ ] 実装前のテストケース作成
- [ ] TypeScript strict modeでのエラーゼロ
- [ ] 偽装・ダミー実装の回避確認
- [ ] エラーハンドリングの実装
- [ ] UTF-8エンコーディングの維持

### **開発終了時（毎夕）**
- [ ] 実装機能の動作確認
- [ ] E2Eテストの実行
- [ ] コードレビュー（セルフチェック）
- [ ] 進捗・課題の記録
- [ ] 翌日計画の策定
- [ ] 文字化け発生の確認・対策

---

**このルールを厳格に遵守することで、既存システムの価値ある設計思想を活かしながら、偽装・破損問題を完全に解決し、4-6週間での高品質システム構築を実現します。** 